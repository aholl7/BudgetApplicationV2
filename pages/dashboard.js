import Head from "next/head"
import Image from "next/image"
import styles from "../styles/Home.module.css";
import Logo from "../public/images/logo.png";
import { useState, useEffect } from "react";
import HomeImage from "../public/images/homeImage.png";
import { 
  Grid, 
  GridItem, 
  Button,   
  FormControl,
  FormLabel,
  FormErrorMessage,
  FormHelperText,
  Input, 
  Box
} from "@chakra-ui/react";
import { db, auth } from "../js/firebase.js";
import {onAuthStateChanged} from "firebase/auth";
const Home = () => {
    const [userInfo, setUserInfo] = useState({firstName: "", lastName: "", email: ""})
    const [loading, setLoading] = useState(true);
  const openSignUp = (e) => {
    e.preventDefault();
    const url = "/signup";
    window.location.href = url;
  }
  const openLogin = (e) => {
    e.preventDefault();
    const url = "/login";
    window.location.href = url;
  }

  const getUserInfo = (uid) => {
    const docRef = doc(db, "users", uid);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
        setUserInfo({firstName: "", lastName: "", email: ""})
        setLoading(false);
      } else {
        // doc.data() will be undefined in this case
        window.alert("No such document!");
      }
  }
  useEffect(()=>{
    onAuthStateChanged(auth, (user) => {
        if (user) {
          // User is signed in, see docs for a list of available properties
          // https://firebase.google.com/docs/reference/js/firebase.User
          const uid = user.uid;

          getUserInfo(uid);

          // ...
        } else {
          // User is signed out
          // ...
        }
      });
  },[]);
  if(loading == true){
      return (
          <p>Loading...</p>
      )
  }else{
    return (
        <div>
        <Head>
            <title>Welcome</title>
            <meta name="description" content="Generated by create next app" />
            <link rel="icon" href="/favicon.ico" />
        </Head>
        
        <main>
            <Grid templateColumns="repeat(3, 1fr)" gap={0}>
            <GridItem colSpan={1} display="flex" marginTop={{base:"8px", md: "20px"}}>
                <Box display={{base: "none", md: "block"}}>
                <Image src={Logo} width={120} height={45} style={{marginTop: "1px"}}/>
                </Box>
                <Box marginLeft={{base: "10px", md: "-30px"}}>
                <h1 id="logo-text">Money Watcher</h1>
                </Box>
                
            </GridItem>

            <GridItem colSpan={2} marginTop="20px" textAlign="right">
                <Button 
                    color="#FFFFFF"
                    width="110px"
                    height="40px"
                    variant="link"
                    _hover={{ color: "#0ACF83"}}
                    marginRight= "10px"
                    onClick={(e) => openLogin(e)}
                >
                    Login
                </Button>
                <Button 
                    color="#FFFFFF"
                    bg="#0ACF83"
                    variant="link"
                    width="110px"
                    height="40px"
                    _hover={{ color: "#0ACF83", bg: "#FFFFFF"}}
                    marginRight={{base: "0px", md: "100px"}}
                    onClick={(e) => openSignUp(e)}
                >
                    Sign Up
                </Button>
            </GridItem>

            </Grid>
            
            <div 
            style={{
                width: "90%", 
                marginLeft: "auto", 
                marginRight: "auto"
            }}
            >
            <Grid templateColumns="repeat(2, 1fr)" gap={1}>
                <GridItem w="100%" colSpan={{base: "2", md:"1"}} marginTop={{base: "100px", md: "170px"}}>
                <h1 
                    style={{
                    color: "#0ACF83", 
                    fontSize: "38px", 
                    fontWeight: "bold"
                    }}
                >
                    Welcome, 
                </h1>
                
                
                
                
                
                </GridItem>
                <GridItem w="100%" textAlign="center" marginTop="80px" display={{base: "none", md: "block"}}>
                <Image src={HomeImage} height={404} width={435} />
                
                </GridItem>
            </Grid>
            
            </div>
            
        </main>
        
        
        </div>
    )
    }
}

export default Home;